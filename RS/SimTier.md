# Enhancing Taobao Display Advertising with Multimodal Representations: Challenges, Approaches and Insights
[原文链接](https://doi.org/10.1145/3383313.3412236)
## 0 摘要：
尽管多模态数据具有提高模型准确性的显著潜力，但包括淘宝展示广告系统在内的许多大规模工业推荐系统在模型中**主要依赖于稀疏的 ID 特征**。在本研究中，我们探索了利用多模态数据来提高推荐准确性的方法。我们从确定在工业系统中采用多模态数据时既有效又经济高效的关键挑战入手。为了解决这些挑战，我们引入了一个两阶段框架，包括：1）对多模态表示进行预训练以捕捉语义相似性，2）将这些表示与现有的基于 ID 的模型相结合。此外，我们详细介绍了我们的生产系统架构，该架构旨在促进多模态表示的部署。自 2023 年年中将多模态表示集成以来，我们观察到淘宝展示广告系统在性能方面有了显著的提升。我们认为，我们所获得的见解将为寻求在系统中利用多模态数据的从业者提供宝贵的资源。

## 背景
多模态数据，其应用能够提升历史行为模型的准确性。具体而言，多模态数据可用于衡量目标物品与用户过往交互物品之间的语义相似度。以物品图片为例，它们可用于衡量目标物品的图片与过往交互物品图片之间的视觉相似度。直观地说，更高的语义相似度意味着目标物品与用户过往行为之间的相似性更强，表明用户的兴趣程度更高。这一见解强调了设计专门的预训练任务的重要性，以便使多模态表示能够有效地辨别不同物品对之间的语义相似度。

## 1 论文解决的问题：
目前大量工业推荐系统完全依赖于身份特征。这通常是因为人们担心多模态数据带来的性能提升可能无法弥补其部署所涉及的成本。因此，多模态表示的成功集成取决于提高其性能优势，同时最小化部署成本的能力。想实现这两个关键目标，必须应对三个实际挑战：
* 预训练任务的设计：多模态表示在提高性能方面的有效性取决于它们提供有意义的语义信息的能力，这是ID特征难以捕获的。设计预训练是必要的使多模态表示能够封装此类语义信息的任务。
* 多模态表示的整合：由于身份识别特征与多模态表示之间存在固有的差异，比如训练周期的不同，这就要求有一些方法能够有效地将多模态表示整合到基于身份识别的模型中。这些方法应当充分利用每种特征类型的优点，以提升模型的整体性能。
* 生产系统的设计：整个生产流程，包括为新物品生成多模态表示以及将其在后续任务中进行及时应用，都应以高效性为设计原则。

## 2 论文创新点：
* 为应对这些挑战，我们采用了如图 1 所示的两阶段框架。具体而言，在预训练阶段，我们提出了语义感知对比学习（SCL）方法。在这个阶段，我们利用用户的搜索查询和随后的购买行为来构建具有语义相似性的样本对，捕捉到在电子商务场景中对用户最为重要的语义相似性的维度。对于负样本，我们从一个大型记忆库中获取。SCL 方法使多模态表示能够有效地衡量项目之间的语义相似性。
* 在获得高质量的多模态表示后，我们提出了两种方法将这些表示融入现有的基于 ID 的模型中。首先，我们开发了一种名为 SimTier 的方法，用于**衡量目标项与用户之前交互过的项之间的相似度**。然后，生成的 SimTier 向量与其他嵌入一起被连接起来，并输入到后续层中。此外，为了解决多模态表示和 ID 嵌入在训练轮数上的差异问题，我们引入了多模态知识提取器（MAKE）模块。MAKE 模块将与多模态表示相关的参数优化与之分离。这些属于基于身份的模型，能够使与多模态表示相关的参数实现更有效的学习。

### 2.1 预训练数据集的构建：
在电子商务的背景下，用户的搜索查询以及随后的购买行为往往表明该查询与所购商品之间存在很强的语义相似性。例如，如果用户搜索一张枕头的图片，然后购买了一款枕头，那么这一系列操作就表明这两张图片（查询到的图片和所购买物品的图片）在语义上足够相似，能够满足用户的购买意愿。因此，如表 1 所示，在训练文本编码器时，我们将用户搜索查询的文本与他们最终购买的商品的标题作为语义相似对进行配对。同样，对于图像模式，用户从淘宝的图片搜索场景中获得的图片查询与后续购买的商品的图片进行配对。这种配对策略自然地捕捉到了与电子商务场景中用户最为相关的语义相似性的维度，反映了影响他们购买决策的因素。

对于每一对语义相似的样本，我们将当前批次中的所有其他样本视为潜在的不相似样本，这可以通过将当前批次中的样本用作负样本来实现。为了进一步提高模型的性能，我们旨在增加训练期间可用的负样本数量。具体而言，我们从 MoCo [12] 中获得灵感，并采用了使用动量更新模型的技术，从而能够从更大的记忆库中更有效地抽取更多负样本。关于构建负样本对的更复杂策略，例如识别困难负样本 [23]，将在第 6.1.2 节中详细阐述。



## 4 模型结构与实现代码：


## 5 实验与分析：

<!--stackedit_data:
eyJoaXN0b3J5IjpbLTIxMjU1NTAyMzEsLTQ4ODEyNzQ3NSwyMD
AzNDE1Mjg1LC01NzQ5ODY0OTYsMTEwNzY5NzYwNCw4OTY3OTk3
ODQsLTg2OTQ2NTE5NF19
-->