# TWIN: TWo-stage Interest Network for Lifelong User Behavior Modeling in CTR Prediction
[原文链接]()
## 0 摘要：
长期用户行为建模，即从数月甚至数年的丰富历史行为中提取用户的潜在兴趣，在现代点击率预测系统中起着核心作用。传统算法大多遵循两个级联阶段：一个简单的通用搜索单元（GSU）用于对数万条长期行为进行快速粗略搜索，以及一个精确搜索单元（ESU）用于对 GSU 中选出的少量候选行为进行有效的目标关注（TA）。尽管高效，但现有算法大多存在一个关键缺陷：**GSU 和 ESU 之间目标行为相关性度量不一致。因此，其 GSU 通常会遗漏高度相关的行为，而检索出 ESU 认为不相关的行为**。在这种情况下，无论 ESU 中如何分配注意力，其目标关注大多偏离了用户的实际兴趣，从而降低了整体点击率预测的准确性。为解决这种不一致性，我们提出了两阶段兴趣网络（TWo-stage Interest Network， TWIN），其中我们的保持一致性的**通用搜索单元（CP-GSU）采用了与 ESU 中的目标关注相同的度量标准，使两个阶段成为“双胞胎”**。具体而言，为突破其计算瓶颈并将其从 ESU 扩展到 GSU，即从行为长度 $10^2$ 扩展到在长度为 $10^4 - 10^5$ 的范围内，我们通过**行为特征拆分构建了一种新颖的注意力机制**。对于行为的固有特征，我们通过高效的**预计算**和**缓存策略**计算其线性投影。而对于用户 - 项目交叉特征，我们在注意力得分计算中将其压缩为一个一维偏差项，以节省计算成本。两个阶段的一致性，以及 CP-GSU 中基于 TA 的有效相关性度量，为 CTR 预测带来了显著的性能提升。在来自快手的 460 亿规模的真实生产数据集上的离线实验以及在线 A/B 测试表明，TWIN 超过了所有比较的 SOTA 算法。通过优化在线基础设施，我们减少了 99.3% 的计算瓶颈，这有助于 TWIN 在快手的成功部署，每天为数亿活跃用户提供主要流量服务。

## 背景


## 1 论文解决的问题：


## 2 论文创新点：


### 2.1 预训练数据集的构建：


### 2.1 技巧：


## 4 模型结构与实现代码：


## 5 实验与分析：

<!--stackedit_data:
eyJoaXN0b3J5IjpbLTEyODMxODEwODUsLTE3MTMwOTAzMTZdfQ
==
-->